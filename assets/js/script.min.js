"use strict";const{__,_x,_n,_nx}=wp.i18n;window.addEventListener('load',(e)=>{A3WCF7FieldsAttributes.init()});class A3WCF7FieldsAttributes{static wrapperId="a3w-attribute-generator";static init(){this.addButtonToTagPanel()}static addButtonToTagPanel(){const tagPanel=document.querySelector(".contact-form-editor-panel #tag-generator-list");if(tagPanel){let textCustomAttributeGenerator=__('Custom attribute generator','a3w-cf7-fields-attributes');const btn=document.createElement('button');btn.id="a3w-attribute-generator-toggle";btn.classList.add('thickbox','button');btn.title=textCustomAttributeGenerator;btn.textContent=textCustomAttributeGenerator;btn.role="button";btn.addEventListener('click',(e)=>{this.openCustomGenerator(e)});tagPanel.appendChild(btn);let editorPanel=document.querySelector(".contact-form-editor-panel");if(editorPanel){editorPanel.insertAdjacentHTML('beforeend',a3wVar.panelHTML.trim());this.addListernersToPanel()}}}static openCustomGenerator(e){e.preventDefault();this.toggleDisplayPanel()}static addListernersToPanel(){const panel=document.getElementById("a3w-attribute-generator");if(panel){let closeElements=panel.getElementsByClassName('close-a3w-generator');if(closeElements){for(let i=0;i<closeElements.length;i++){closeElements[i].addEventListener('click',(e)=>{e.preventDefault();this.toggleDisplayPanel()})}}let btns=panel.querySelectorAll('button');if(btns){for(let i=0;i<btns.length;i++){btns[i].addEventListener('click',(e)=>{e.preventDefault()})}}let inputAttrName=document.getElementById("a3w-attr-name");if(inputAttrName){inputAttrName.addEventListener('input',(e)=>{this.setAttrName(e.currentTarget.value)})}let inputAttrContent=document.getElementById("a3w-attr-content");if(inputAttrContent){inputAttrContent.addEventListener('input',(e)=>{this.setAttrContent(e.currentTarget.value)})}const attrElement=document.getElementById("a3w-attr-cf7");if(attrElement){attrElement.addEventListener('input',(e)=>{this.setAttrName();this.setAttrContent()})}let copyclickElements=panel.getElementsByClassName('a3w-attr-copy');if(copyclickElements){for(let i=0;i<copyclickElements.length;i++){copyclickElements[i].addEventListener('click',(e)=>{this.copyGeneratedAttribute(e)})}}}}static toggleDisplayPanel(){const panel=document.getElementById("a3w-attribute-generator");if(panel){if(panel.style.display=='none'){panel.style.display='flex';panel.classList.add('opened');let closeBtn=panel.querySelector(".panel-header .close");if(closeBtn){closeBtn.focus({focusVisible:true})}}else{panel.style.display='none';panel.classList.remove('opened')}}}static copyGeneratedAttribute(e){const attrElement=document.getElementById("a3w-attr-cf7");if(attrElement){attrElement.select();attrElement.setSelectionRange(0,99999);navigator.clipboard.writeText(attrElement.value);let spanElement=document.createElement("span");spanElement.classList.add("copy-confirmed");spanElement.textContent=__('Copied!','a3w-cf7-fields-attributes');attrElement.parentNode.appendChild(spanElement);setTimeout(function(){spanElement.remove()},1500)}}static setAttrName(text=null){if(text===null){const inputAttrName=document.getElementById("a3w-attr-name");if(inputAttrName){text=inputAttrName.value}else{text=""}}const attrElement=document.getElementById("a3w-attr-cf7");if(attrElement){let currentValue=attrElement.value;let parts=currentValue.split(':');text=text.normalize("NFD").replace(/[\u0300-\u036f]/gi,"");text=text.replace(/\s/gi,"-");let name='attr_'+text.toLowerCase();if(parts.length>1){attrElement.value=name+":"+parts[1]}else{attrElement.value=name+":"}}}static setAttrContent(text=null){if(text===null){const inputAttrContent=document.getElementById("a3w-attr-content");if(inputAttrContent){text=inputAttrContent.value}else{text=""}}const attrElement=document.getElementById("a3w-attr-cf7");if(attrElement){let currentValue=attrElement.value;let parts=currentValue.split(':');text=text.replace(/\'/gi,"&apos;");let content=encodeURIComponent(text.trim());if(parts.length>0){attrElement.value=parts[0]+":"+content}else{attrElement.value=":"+content}}}}
